<html>
<head>
  <title>Experiment Site</title>
  <script src='https://static-assets.mapbox.com/gl-pricing/dist/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />
  <script src='https://npmcdn.com/@turf/turf/turf.min.js'></script>
  <script src="kriging.js"></script>
  <script src="node_modules/js-regression/build/jsregression.min.js"></script>
</head>
<body>
  <div style="width: 100%; height: 100%" id="map">
  </div>

  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiY29zbW93YW5nIiwiYSI6ImNqdWl0bG50ODFlZ2w0ZnBnc3VyejZmbWQifQ.5TjxQgPSj6B7VcFkvSfqBA';

    const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/light-v10',
      center: [-122.3155224, 47.6583362],
      zoom: 15
    });

    const data = {
      "features":[
        {
            "geometry":{
              "coordinates":[
                  -122.3156015,
                  47.6583997
              ],
              "type":"Point"
            },
            "properties":{
              "cost":6.031763140322754
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3154351,
                  47.6583977
              ],
              "type":"Point"
            },
            "properties":{
              "cost":6.468236859677247
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3156045,
                  47.6582873
              ],
              "type":"Point"
            },
            "properties":{
              "cost":18.531763140322752
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3154381,
                  47.6582853
              ],
              "type":"Point"
            },
            "properties":{
              "cost":18.968236859677248
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3165426,
                  47.6584109
              ],
              "type":"Point"
            },
            "properties":{
              "cost":76.71176314032276
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3144775,
                  47.6583862
              ],
              "type":"Point"
            },
            "properties":{
              "cost":78.38823685967725
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3165453,
                  47.6582985
              ],
              "type":"Point"
            },
            "properties":{
              "cost":89.19176314032275
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3144865,
                  47.6582739
              ],
              "type":"Point"
            },
            "properties":{
              "cost":90.42823685967724
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.316778,
                  47.6584137
              ],
              "type":"Point"
            },
            "properties":{
              "cost":94.39176314032277
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3142374,
                  47.658408
              ],
              "type":"Point"
            },
            "properties":{
              "cost":96.57823685967725
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3167685,
                  47.6583011
              ],
              "type":"Point"
            },
            "properties":{
              "cost":105.95176314032275
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3142437,
                  47.6582463
              ],
              "type":"Point"
            },
            "properties":{
              "cost":108.91823685967724
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3155661,
                  47.6597485
              ],
              "type":"Point"
            },
            "properties":{
              "cost":155.96176314032277
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3153996,
                  47.6597482
              ],
              "type":"Point"
            },
            "properties":{
              "cost":156.59823685967723
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3176669,
                  47.6584242
              ],
              "type":"Point"
            },
            "properties":{
              "cost":161.15176314032277
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3133289,
                  47.6583972
              ],
              "type":"Point"
            },
            "properties":{
              "cost":164.80823685967724
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3154732,
                  47.6569503
              ],
              "type":"Point"
            },
            "properties":{
              "cost":167.36823685967724
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3156396,
                  47.6569496
              ],
              "type":"Point"
            },
            "properties":{
              "cost":167.23176314032276
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3155946,
                  47.6598997
              ],
              "type":"Point"
            },
            "properties":{
              "cost":172.90176314032277
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3153551,
                  47.6598981
              ],
              "type":"Point"
            },
            "properties":{
              "cost":173.58823685967724
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3176699,
                  47.6583118
              ],
              "type":"Point"
            },
            "properties":{
              "cost":173.65176314032277
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.313325,
                  47.6582353
              ],
              "type":"Point"
            },
            "properties":{
              "cost":177.90823685967723
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3178902,
                  47.6584268
              ],
              "type":"Point"
            },
            "properties":{
              "cost":177.92176314032278
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3165768,
                  47.6574883
              ],
              "type":"Point"
            },
            "properties":{
              "cost":179.26176314032276
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3165773,
                  47.6574764
              ],
              "type":"Point"
            },
            "properties":{
              "cost":180.58176314032275
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3130814,
                  47.6583888
              ],
              "type":"Point"
            },
            "properties":{
              "cost":183.40823685967723
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3154777,
                  47.6567762
              ],
              "type":"Point"
            },
            "properties":{
              "cost":186.71823685967723
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3156564,
                  47.6567742
              ],
              "type":"Point"
            },
            "properties":{
              "cost":186.76176314032276
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3178932,
                  47.6583144
              ],
              "type":"Point"
            },
            "properties":{
              "cost":190.41176314032276
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3130935,
                  47.658238
              ],
              "type":"Point"
            },
            "properties":{
              "cost":195.28823685967723
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3167889,
                  47.6574921
              ],
              "type":"Point"
            },
            "properties":{
              "cost":195.19176314032276
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3178917,
                  47.6583706
              ],
              "type":"Point"
            },
            "properties":{
              "cost":196.66176314032276
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3178902,
                  47.6584269
              ],
              "type":"Point"
            },
            "properties":{
              "cost":202.91176314032276
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.316599,
                  47.6571173
              ],
              "type":"Point"
            },
            "properties":{
              "cost":220.53176314032277
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3165074,
                  47.6597598
              ],
              "type":"Point"
            },
            "properties":{
              "cost":226.65176314032277
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.314442,
                  47.6597364
              ],
              "type":"Point"
            },
            "properties":{
              "cost":228.46823685967723
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3169709,
                  47.6572051
              ],
              "type":"Point"
            },
            "properties":{
              "cost":229.99176314032275
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3167696,
                  47.657122
              ],
              "type":"Point"
            },
            "properties":{
              "cost":233.35176314032276
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3156682,
                  47.6563254
              ],
              "type":"Point"
            },
            "properties":{
              "cost":236.65176314032277
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3166084,
                  47.6569613
              ],
              "type":"Point"
            },
            "properties":{
              "cost":237.88176314032276
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3145216,
                  47.6569388
              ],
              "type":"Point"
            },
            "properties":{
              "cost":238.82823685967725
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3154903,
                  47.6562992
              ],
              "type":"Point"
            },
            "properties":{
              "cost":239.73823685967724
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3164994,
                  47.6599105
              ],
              "type":"Point"
            },
            "properties":{
              "cost":240.85176314032276
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3144401,
                  47.6598872
              ],
              "type":"Point"
            },
            "properties":{
              "cost":242.31823685967726
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3142026,
                  47.6597335
              ],
              "type":"Point"
            },
            "properties":{
              "cost":243.91823685967722
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3167428,
                  47.6597626
              ],
              "type":"Point"
            },
            "properties":{
              "cost":244.33176314032278
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3167758,
                  47.6569331
              ],
              "type":"Point"
            },
            "properties":{
              "cost":250.83176314032275
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3121484,
                  47.6583778
              ],
              "type":"Point"
            },
            "properties":{
              "cost":253.47823685967722
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3154911,
                  47.6561718
              ],
              "type":"Point"
            },
            "properties":{
              "cost":253.89823685967724
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3156576,
                  47.6561732
              ],
              "type":"Point"
            },
            "properties":{
              "cost":253.59176314032277
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3176886,
                  47.6575844
              ],
              "type":"Point"
            },
            "properties":{
              "cost":254.50176314032277
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3142785,
                  47.6569221
              ],
              "type":"Point"
            },
            "properties":{
              "cost":256.1082368596772
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3168491,
                  47.6569339
              ],
              "type":"Point"
            },
            "properties":{
              "cost":256.3417631403227
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31659,
                  47.6567855
              ],
              "type":"Point"
            },
            "properties":{
              "cost":256.88176314032273
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3167226,
                  47.6599132
              ],
              "type":"Point"
            },
            "properties":{
              "cost":257.61176314032275
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3145262,
                  47.6567647
              ],
              "type":"Point"
            },
            "properties":{
              "cost":258.1782368596772
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3141966,
                  47.6598843
              ],
              "type":"Point"
            },
            "properties":{
              "cost":260.6082368596773
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.312197,
                  47.6582275
              ],
              "type":"Point"
            },
            "properties":{
              "cost":262.6182368596772
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3176905,
                  47.6575129
              ],
              "type":"Point"
            },
            "properties":{
              "cost":262.4617631403228
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3167999,
                  47.6568209
              ],
              "type":"Point"
            },
            "properties":{
              "cost":263.43176314032274
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3154898,
                  47.6560743
              ],
              "type":"Point"
            },
            "properties":{
              "cost":264.7282368596772
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3156563,
                  47.6560761
              ],
              "type":"Point"
            },
            "properties":{
              "cost":264.3917631403228
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3172259,
                  47.6569233
              ],
              "type":"Point"
            },
            "properties":{
              "cost":266.7017631403227
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3168519,
                  47.6568215
              ],
              "type":"Point"
            },
            "properties":{
              "cost":267.34176314032277
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3176397,
                  47.6593971
              ],
              "type":"Point"
            },
            "properties":{
              "cost":269.30176314032275
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3179119,
                  47.6575871
              ],
              "type":"Point"
            },
            "properties":{
              "cost":271.2617631403228
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3142823,
                  47.6567768
              ],
              "type":"Point"
            },
            "properties":{
              "cost":272.2582368596772
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3176928,
                  47.657428
              ],
              "type":"Point"
            },
            "properties":{
              "cost":271.8917631403228
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3170892,
                  47.65685
              ],
              "type":"Point"
            },
            "properties":{
              "cost":271.9517631403228
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3118846,
                  47.6583747
              ],
              "type":"Point"
            },
            "properties":{
              "cost":273.2882368596772
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.317097,
                  47.6568434
              ],
              "type":"Point"
            },
            "properties":{
              "cost":272.8917631403228
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3176381,
                  47.6594545
              ],
              "type":"Point"
            },
            "properties":{
              "cost":275.69176314032273
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3154948,
                  47.6559328
              ],
              "type":"Point"
            },
            "properties":{
              "cost":280.45823685967724
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.315661,
                  47.6559354
              ],
              "type":"Point"
            },
            "properties":{
              "cost":280.03176314032277
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3173446,
                  47.6568274
              ],
              "type":"Point"
            },
            "properties":{
              "cost":280.6017631403227
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3118865,
                  47.6582993
              ],
              "type":"Point"
            },
            "properties":{
              "cost":281.6682368596772
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3176363,
                  47.659509
              ],
              "type":"Point"
            },
            "properties":{
              "cost":281.75176314032274
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3118875,
                  47.6582258
              ],
              "type":"Point"
            },
            "properties":{
              "cost":285.8582368596772
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3171987,
                  47.6567527
              ],
              "type":"Point"
            },
            "properties":{
              "cost":285.54176314032276
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.315574,
                  47.655934
              ],
              "type":"Point"
            },
            "properties":{
              "cost":286.40823685967723
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3178648,
                  47.6593999
              ],
              "type":"Point"
            },
            "properties":{
              "cost":286.2117631403228
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3179157,
                  47.6574308
              ],
              "type":"Point"
            },
            "properties":{
              "cost":288.6317631403228
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3178619,
                  47.6595124
              ],
              "type":"Point"
            },
            "properties":{
              "cost":298.69176314032273
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3177065,
                  47.6569222
              ],
              "type":"Point"
            },
            "properties":{
              "cost":296.76
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3166049,
                  47.6563658
              ],
              "type":"Point"
            },
            "properties":{
              "cost":297.51
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31675384612053,
                  47.6593384851446
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31760289567084,
                  47.65683048080963
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31391288229018,
                  47.65677233513298
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31428886336992,
                  47.6565272361235
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31681153057319,
                  47.65649196519007
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31786319953393,
                  47.6594619439741
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31786773338033,
                  47.659288067880645
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31804843797904,
                  47.65940033920493
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31592689597169,
                  47.65593948832622
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31523461496596,
                  47.65592862334944
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31660407646594,
                  47.656388159327044
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31770568161153,
                  47.656951387321236
              ],
              "type":"Point"
            },
            "properties":{
              "cost":352.98
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31769962957092,
                  47.657175135861365
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31648541979153,
                  47.66044263762116
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31305386980841,
                  47.65943759974255
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3179150613001,
                  47.65745782887792
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31829457022864,
                  47.657587714662185
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31652348034196,
                  47.656960236494
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31345579223988,
                  47.659724504287645
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31335376918733,
                  47.65713697004829
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31220579487244,
                  47.65789125142447
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31213742720013,
                  47.65879634124567
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31329689957697,
                  47.65961336365334
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31442644277794,
                  47.660406095494196
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31532513431674,
                  47.661035320360654
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31369402254866,
                  47.65691505642889
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31786158559278,
                  47.659524140114634
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31787931217886,
                  47.659512408508
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31763100993604,
                  47.65967317857881
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31556447259743,
                  47.66104309316277
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31451129847059,
                  47.65733122188161
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31188905759689,
                  47.65809853645219
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31730822733971,
                  47.65665510971689
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31187828509063,
                  47.65861497986207
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31748407060756,
                  47.659771637921686
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31311819837099,
                  47.657296047505156
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31468790033186,
                  47.65629220321041
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3176633265586,
                  47.65692233875312
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31770592892642,
                  47.656893079999996
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31774961151623,
                  47.65692270787004
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3136720223742,
                  47.65987795336535
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31418724145952,
                  47.66023862718495
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31649190202033,
                  47.65633262855659
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31453609348236,
                  47.656388409143126
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31671259798807,
                  47.660294558162796
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31728702674444,
                  47.659920095978464
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31791816287533,
                  47.65732848234346
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.31806712492853,
                  47.65743100811022
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        },
        {
            "geometry":{
              "coordinates":[
                  -122.3144450707144,
                  47.65973637105736
              ],
              "type":"Point"
            },
            "properties":{
              "cost":300
            },
            "type":"Feature"
        }
      ],
      "type":"FeatureCollection"
    }

    const breaks = [0, 50, 100, 150, 200, 250, 300];
    const colors = ["#67001f", "#980043", "#ce1256", "#e7298a", "#df65b0", "#c994c7", "#d4b9da"];


    // let options = {gridType: 'points', property: 'cost', units: 'kilometers', weight: 50};
    let pointGrid = krigingInterpolate(data)
    // console.log(pointGrid);
    // console.log(pointGrid2);

    
    // let contours = turf.isobands(pointGrid, breaks, {zProperty: "cost"})
    // console.log(contours);

    console.log(regression(data));

    function regression(data) {
      let pointGrid = turf.pointGrid(turf.bbox(data), 0.005);
      let input = [];
      let output = [];
      turf.featureEach(data, function(dataPoint) {
        input.push(dataPoint.geometry.coordinates);
        output.push([dataPoint.properties.cost, dataPoint.properties.cost]);
      })
      let model = new ML.MultivariateLinearRegression(input, output);
      turf.featureEach(pointGrid, function(gridPoint){
        let x = gridPoint.geometry.coordinates[1];
        let y = gridPoint.geometry.coordinates[0];
        let z = model.predict([x, y]);
        // console.log(z);
        gridPoint.properties.cost = z;
      });
      return pointGrid;
    };
    

    /**
     * Interpolate values based on given data points using kriging algorithm.
     */
    function krigingInterpolate(data) {
      let pointGrid = turf.pointGrid(turf.bbox(data), 0.005);
      let xs = [];
      let ys = [];
      let zs = [];
      turf.featureEach(data, function(dataPoint) {
        xs.push(dataPoint.geometry.coordinates[1]);
        ys.push(dataPoint.geometry.coordinates[0]);
        zs.push(dataPoint.properties.cost);
      });

      let model = "exponential";
      let sigma2 = 0;
      let alpha = 100;
      let fitModel = kriging.train(zs, xs, ys, model, sigma2, alpha);

      turf.featureEach(pointGrid, function(gridPoint) {
        let x = gridPoint.geometry.coordinates[1];
        let y = gridPoint.geometry.coordinates[0];
        gridPoint.properties.cost = kriging.predict(x, y, fitModel);
      });
      return pointGrid;
    }


    /**
     * Adds a Mapbox Marker at given longitude and latitude.
     * @param {double} lng - longitude of the position
     * @param {double} lat - latitude of the position
     * @return - A Mapbox Marker at the given position
     */
    function addMarker(lng, lat) {
      return new mapboxgl.Marker()
                .setLngLat([lng, lat])
                .setDraggable(true)
                .addTo(map);
    }

    /**
     * Creats a GeoJSON Feature that contains a LineString
     * that outlines the border of the given GeoJSON data.
     * @param {GeoJSON} data - the GeoJSON data that contains
     *                         a FeatureCollection of points
     * @return - a GeoJSON Feature
     */
    function createBounds(data) {
      let sw = mapboxgl.LngLat.convert(data.features[0].geometry.coordinates);
      let ne = mapboxgl.LngLat.convert(data.features[0].geometry.coordinates);
      for (let i = 1; i < data.features.length; i++) {
        let curCoord = mapboxgl.LngLat.convert(data.features[i].geometry.coordinates);
        if (curCoord.lng < sw.lng) {
          sw.lng = curCoord.lng;
        }
        if (curCoord.lat < sw.lat) {
          sw.lat = curCoord.lat;
        }
        if (curCoord.lng > ne.lng) {
          ne.lng = curCoord.lng;
        }
        if (curCoord.lat > ne.lat) {
          ne.lat = curCoord.lat;
        }
      }
      let se = new mapboxgl.LngLat(ne.lng, sw.lat);
      let nw = new mapboxgl.LngLat(sw.lng, ne.lat);

      let bound = {};
      bound.type = "Feature";
      bound.properties = {};
      bound.geometry = {};
      bound.geometry.type = "LineString";
      bound.geometry.coordinates = [];
      bound.geometry.coordinates.push(sw.toArray());
      bound.geometry.coordinates.push(se.toArray());
      bound.geometry.coordinates.push(ne.toArray());
      bound.geometry.coordinates.push(nw.toArray());
      bound.geometry.coordinates.push(sw.toArray());
      return bound;
    }
    

    map.on("load", function() {
      // map.addLayer({
      //   "id": "points_values",
      //   "type": "symbol",
      //   "source": {
      //     "type": "geojson",
      //     "data": data
      //   },
      //   "layout": {
      //     "text-field": "{cost}"
      //   }
      // });

      map.addSource("points", {
          "type": "geojson",
          "data": data
      });

      map.addLayer({
        "id": "points",
        "type": "circle",
        "source": "points",
        "paint": {
          "circle-color": [
            "interpolate",
            ["linear"],
            ["get", "cost"],
            0, "#67001f",
            50, "#980043",
            100, "#ce1256",
            150, "#e7298a",
            200, "#df65b0",
            250, "#c994c7",
            300, "#d4b9da"
          ]
        }
      });

      // let bound = createBounds(data);
      // map.addLayer({
      //   "id": "bound",
      //   "type": "line",
      //   "source": {
      //     "type": "geojson",
      //     "data": bound
      //   },
      //   "layout": {
      //     "line-join": "round",
      //     "line-cap": "round"
      //   },
      //   "paint": {
      //     "line-color": "#888",
      //     "line-width": 5
      //   }
      // });
      // console.log(contours.features.length);
      for (let i = 0; i < contours.features.length; i++) {
        map.addLayer({
          "id": "contours" + i,
          "type": "fill",
          "source": {
            "type": "geojson",
            "data": contours.features[i]
          },
          "paint": {
            "fill-color": colors[i],
            "fill-opacity": 0.5
          }
        });
      }
    });
  </script>
</body>
</html>
